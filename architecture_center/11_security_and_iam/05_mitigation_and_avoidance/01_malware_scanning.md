# Automate Malware Scanning for Cloud Storage

This event-driven pipeline automatically scans files uploaded to Cloud Storage for malicious code using ClamAV.

## Scanning Pipeline
1.  **Upload**: User uploads a file to a designated **unscanned** GCS bucket.
2.  **Trigger**: **Eventarc** detects the upload and sends a trigger to a **Cloud Run** service.
3.  **Scan**: The Cloud Run service:
    -   Downloads the file.
    -   Scans it using the **ClamAV** engine.
4.  **Categorization**:
    -   **Clean**: File is moved to a **clean** GCS bucket.
    -   **Malicious**: File is moved to a **quarantine** GCS bucket.
5.  **Logging**: Results are reported to **Cloud Logging** and **Cloud Monitoring**.

## Database Mirror Update
To ensure up-to-date threat signatures and avoid rate-limiting from ClamAV public servers:
1.  **Cloud Scheduler** triggers a Cloud Run update job every 2 hours.
2.  The job downloads updates and maintains a **private local mirror** of the ClamAV database in a separate GCS bucket.
3.  The scanning Cloud Run instances pull signatures from this private mirror on startup and periodically during runtime.
